require( 'ffi/winapi/headers/windows' )
require( 'ffi/winapi/headers/network' )
local ffi = require( 'ffi' )
ffi.cdef [[
  typedef LPWSTR LMSTR; //Alias
  typedef ULONG WINAPI_DsDomainFlags; //Alias
  typedef struct DS_DOMAIN_TRUSTS {
    LPTSTR NetbiosDomainName;
    LPTSTR DnsDomainName;
    WINAPI_DsDomainFlags Flags;
    ULONG ParentIndex;
    ULONG TrustType;
    ULONG TrustAttributes;
    PSID DomainSid;
    GUID DomainGuid;
  } DS_DOMAIN_TRUSTS;
  typedef DS_DOMAIN_TRUSTS *PDS_DOMAIN_TRUSTS; //Pointer
  typedef struct DOMAIN_CONTROLLER_INFO {
    LPTSTR DomainControllerName;
    LPTSTR DomainControllerAddress;
    ULONG DomainControllerAddressType;
    GUID DomainGuid;
    LPTSTR DomainName;
    LPTSTR DnsForestName;
    ULONG Flags;
    LPTSTR DcSiteName;
    LPTSTR ClientSiteName;
  } DOMAIN_CONTROLLER_INFO;
  typedef DOMAIN_CONTROLLER_INFO *PDOMAIN_CONTROLLER_INFO; //Pointer
  typedef DWORD NET_API_STATUS; //Alias
  static const DWORD NERR_Success = 0;
  static const DWORD NERR_NetNotStarted = 2102;
  static const DWORD NERR_UnknownServer = 2103;
  static const DWORD NERR_ShareMem = 2104;
  static const DWORD NERR_NoNetworkResource = 2105;
  static const DWORD NERR_RemoteOnly = 2106;
  static const DWORD NERR_DevNotRedirected = 2107;
  static const DWORD NERR_ServerNotStarted = 2114;
  static const DWORD NERR_ItemNotFound = 2115;
  static const DWORD NERR_UnknownDevDir = 2116;
  static const DWORD NERR_RedirectedPath = 2117;
  static const DWORD NERR_DuplicateShare = 2118;
  static const DWORD NERR_NoRoom = 2119;
  static const DWORD NERR_TooManyItems = 2121;
  static const DWORD NERR_InvalidMaxUsers = 2122;
  static const DWORD NERR_BufTooSmall = 2123;
  static const DWORD NERR_RemoteErr = 2127;
  static const DWORD NERR_LanmanIniError = 2131;
  static const DWORD NERR_NetworkError = 2136;
  static const DWORD NERR_WkstaInconsistentState = 2137;
  static const DWORD NERR_WkstaNotStarted = 2138;
  static const DWORD NERR_BrowserNotStarted = 2139;
  static const DWORD NERR_InternalError = 2140;
  static const DWORD NERR_BadTransactConfig = 2141;
  static const DWORD NERR_InvalidAPI = 2142;
  static const DWORD NERR_BadEventName = 2143;
  static const DWORD NERR_DupNameReboot = 2144;
  static const DWORD NERR_CfgCompNotFound = 2146;
  static const DWORD NERR_CfgParamNotFound = 2147;
  static const DWORD NERR_LineTooLong = 2149;
  static const DWORD NERR_QNotFound = 2150;
  static const DWORD NERR_JobNotFound = 2151;
  static const DWORD NERR_DestNotFound = 2152;
  static const DWORD NERR_DestExists = 2153;
  static const DWORD NERR_QExists = 2154;
  static const DWORD NERR_QNoRoom = 2155;
  static const DWORD NERR_JobNoRoom = 2156;
  static const DWORD NERR_DestNoRoom = 2157;
  static const DWORD NERR_DestIdle = 2158;
  static const DWORD NERR_DestInvalidOp = 2159;
  static const DWORD NERR_ProcNoRespond = 2160;
  static const DWORD NERR_SpoolerNotLoaded = 2161;
  static const DWORD NERR_DestInvalidState = 2162;
  static const DWORD NERR_QInvalidState = 2163;
  static const DWORD NERR_JobInvalidState = 2164;
  static const DWORD NERR_SpoolNoMemory = 2165;
  static const DWORD NERR_DriverNotFound = 2166;
  static const DWORD NERR_DataTypeInvalid = 2167;
  static const DWORD NERR_ProcNotFound = 2168;
  static const DWORD NERR_ServiceTableLocked = 2180;
  static const DWORD NERR_ServiceTableFull = 2181;
  static const DWORD NERR_ServiceInstalled = 2182;
  static const DWORD NERR_ServiceEntryLocked = 2183;
  static const DWORD NERR_ServiceNotInstalled = 2184;
  static const DWORD NERR_BadServiceName = 2185;
  static const DWORD NERR_ServiceCtlTimeout = 2186;
  static const DWORD NERR_ServiceCtlBusy = 2187;
  static const DWORD NERR_BadServiceProgName = 2188;
  static const DWORD NERR_ServiceNotCtrl = 2189;
  static const DWORD NERR_ServiceKillProc = 2190;
  static const DWORD NERR_ServiceCtlNotValid = 2191;
  static const DWORD NERR_NotInDispatchTbl = 2192;
  static const DWORD NERR_BadControlRecv = 2193;
  static const DWORD NERR_ServiceNotStarting = 2194;
  static const DWORD NERR_AlreadyLoggedOn = 2200;
  static const DWORD NERR_NotLoggedOn = 2201;
  static const DWORD NERR_BadUsername = 2202;
  static const DWORD NERR_BadPassword = 2203;
  static const DWORD NERR_UnableToAddName_W = 2204;
  static const DWORD NERR_UnableToAddName_F = 2205;
  static const DWORD NERR_UnableToDelName_W = 2206;
  static const DWORD NERR_UnableToDelName_F = 2207;
  static const DWORD NERR_LogonsPaused = 2209;
  static const DWORD NERR_LogonServerConflict = 2210;
  static const DWORD NERR_LogonNoUserPath = 2211;
  static const DWORD NERR_LogonScriptError = 2212;
  static const DWORD NERR_StandaloneLogon = 2214;
  static const DWORD NERR_LogonServerNotFound = 2215;
  static const DWORD NERR_LogonDomainExists = 2216;
  static const DWORD NERR_NonValidatedLogon = 2217;
  static const DWORD NERR_ACFNotFound = 2219;
  static const DWORD NERR_GroupNotFound = 2220;
  static const DWORD NERR_UserNotFound = 2221;
  static const DWORD NERR_ResourceNotFound = 2222;
  static const DWORD NERR_GroupExists = 2223;
  static const DWORD NERR_UserExists = 2224;
  static const DWORD NERR_ResourceExists = 2225;
  static const DWORD NERR_NotPrimary = 2226;
  static const DWORD NERR_ACFNotLoaded = 2227;
  static const DWORD NERR_ACFNoRoom = 2228;
  static const DWORD NERR_ACFFileIOFail = 2229;
  static const DWORD NERR_ACFTooManyLists = 2230;
  static const DWORD NERR_UserLogon = 2231;
  static const DWORD NERR_ACFNoParent = 2232;
  static const DWORD NERR_CanNotGrowSegment = 2233;
  static const DWORD NERR_SpeGroupOp = 2234;
  static const DWORD NERR_NotInCache = 2235;
  static const DWORD NERR_UserInGroup = 2236;
  static const DWORD NERR_UserNotInGroup = 2237;
  static const DWORD NERR_AccountUndefined = 2238;
  static const DWORD NERR_AccountExpired = 2239;
  static const DWORD NERR_InvalidWorkstation = 2240;
  static const DWORD NERR_InvalidLogonHours = 2241;
  static const DWORD NERR_PasswordExpired = 2242;
  static const DWORD NERR_PasswordCantChange = 2243;
  static const DWORD NERR_PasswordHistConflict = 2244;
  static const DWORD NERR_PasswordTooShort = 2245;
  static const DWORD NERR_PasswordTooRecent = 2246;
  static const DWORD NERR_InvalidDatabase = 2247;
  static const DWORD NERR_DatabaseUpToDate = 2248;
  static const DWORD NERR_SyncRequired = 2249;
  static const DWORD NERR_UseNotFound = 2250;
  static const DWORD NERR_BadAsgType = 2251;
  static const DWORD NERR_DeviceIsShared = 2252;
  static const DWORD NERR_SameAsComputerName = 2253;
  static const DWORD NERR_NoComputerName = 2270;
  static const DWORD NERR_MsgAlreadyStarted = 2271;
  static const DWORD NERR_MsgInitFailed = 2272;
  static const DWORD NERR_NameNotFound = 2273;
  static const DWORD NERR_AlreadyForwarded = 2274;
  static const DWORD NERR_AddForwarded = 2275;
  static const DWORD NERR_AlreadyExists = 2276;
  static const DWORD NERR_TooManyNames = 2277;
  static const DWORD NERR_DelComputerName = 2278;
  static const DWORD NERR_LocalForward = 2279;
  static const DWORD NERR_GrpMsgProcessor = 2280;
  static const DWORD NERR_PausedRemote = 2281;
  static const DWORD NERR_BadReceive = 2282;
  static const DWORD NERR_NameInUse = 2283;
  static const DWORD NERR_MsgNotStarted = 2284;
  static const DWORD NERR_NotLocalName = 2285;
  static const DWORD NERR_NoForwardName = 2286;
  static const DWORD NERR_RemoteFull = 2287;
  static const DWORD NERR_NameNotForwarded = 2288;
  static const DWORD NERR_TruncatedBroadcast = 2289;
  static const DWORD NERR_InvalidDevice = 2294;
  static const DWORD NERR_WriteFault = 2295;
  static const DWORD NERR_DuplicateName = 2297;
  static const DWORD NERR_DeleteLater = 2298;
  static const DWORD NERR_IncompleteDel = 2299;
  static const DWORD NERR_MultipleNets = 2300;
  static const DWORD NERR_NetNameNotFound = 2310;
  static const DWORD NERR_DeviceNotShared = 2311;
  static const DWORD NERR_ClientNameNotFound = 2312;
  static const DWORD NERR_FileIdNotFound = 2314;
  static const DWORD NERR_ExecFailure = 2315;
  static const DWORD NERR_TmpFile = 2316;
  static const DWORD NERR_TooMuchData = 2317;
  static const DWORD NERR_DeviceShareConflict = 2318;
  static const DWORD NERR_BrowserTableIncomplete = 2319;
  static const DWORD NERR_NotLocalDomain = 2320;
  static const DWORD NERR_IsDfsShare = 2321;
  static const DWORD NERR_DevInvalidOpCode = 2331;
  static const DWORD NERR_DevNotFound = 2332;
  static const DWORD NERR_DevNotOpen = 2333;
  static const DWORD NERR_BadQueueDevString = 2334;
  static const DWORD NERR_BadQueuePriority = 2335;
  static const DWORD NERR_NoCommDevs = 2337;
  static const DWORD NERR_QueueNotFound = 2338;
  static const DWORD NERR_BadDevString = 2340;
  static const DWORD NERR_BadDev = 2341;
  static const DWORD NERR_InUseBySpooler = 2342;
  static const DWORD NERR_CommDevInUse = 2343;
  static const DWORD NERR_InvalidComputer = 2351;
  static const DWORD NERR_MaxLenExceeded = 2354;
  static const DWORD NERR_BadComponent = 2356;
  static const DWORD NERR_CantType = 2357;
  static const DWORD NERR_TooManyEntries = 2362;
  static const DWORD NERR_ProfileFileTooBig = 2370;
  static const DWORD NERR_ProfileOffset = 2371;
  static const DWORD NERR_ProfileCleanup = 2372;
  static const DWORD NERR_ProfileUnknownCmd = 2373;
  static const DWORD NERR_ProfileLoadErr = 2374;
  static const DWORD NERR_ProfileSaveErr = 2375;
  static const DWORD NERR_LogOverflow = 2377;
  static const DWORD NERR_LogFileChanged = 2378;
  static const DWORD NERR_LogFileCorrupt = 2379;
  static const DWORD NERR_SourceIsDir = 2380;
  static const DWORD NERR_BadSource = 2381;
  static const DWORD NERR_BadDest = 2382;
  static const DWORD NERR_DifferentServers = 2383;
  static const DWORD NERR_RunSrvPaused = 2385;
  static const DWORD NERR_ErrCommRunSrv = 2389;
  static const DWORD NERR_ErrorExecingGhost = 2391;
  static const DWORD NERR_ShareNotFound = 2392;
  static const DWORD NERR_InvalidLana = 2400;
  static const DWORD NERR_OpenFiles = 2401;
  static const DWORD NERR_ActiveConns = 2402;
  static const DWORD NERR_BadPasswordCore = 2403;
  static const DWORD NERR_DevInUse = 2404;
  static const DWORD NERR_LocalDrive = 2405;
  static const DWORD NERR_AlertExists = 2430;
  static const DWORD NERR_TooManyAlerts = 2431;
  static const DWORD NERR_NoSuchAlert = 2432;
  static const DWORD NERR_BadRecipient = 2433;
  static const DWORD NERR_AcctLimitExceeded = 2434;
  static const DWORD NERR_InvalidLogSeek = 2440;
  static const DWORD NERR_BadUasConfig = 2450;
  static const DWORD NERR_InvalidUASOp = 2451;
  static const DWORD NERR_LastAdmin = 2452;
  static const DWORD NERR_DCNotFound = 2453;
  static const DWORD NERR_LogonTrackingError = 2454;
  static const DWORD NERR_NetlogonNotStarted = 2455;
  static const DWORD NERR_CanNotGrowUASFile = 2456;
  static const DWORD NERR_TimeDiffAtDC = 2457;
  static const DWORD NERR_PasswordMismatch = 2458;
  static const DWORD NERR_NoSuchServer = 2460;
  static const DWORD NERR_NoSuchSession = 2461;
  static const DWORD NERR_NoSuchConnection = 2462;
  static const DWORD NERR_TooManyServers = 2463;
  static const DWORD NERR_TooManySessions = 2464;
  static const DWORD NERR_TooManyConnections = 2465;
  static const DWORD NERR_TooManyFiles = 2466;
  static const DWORD NERR_NoAlternateServers = 2467;
  static const DWORD NERR_TryDownLevel = 2470;
  static const DWORD NERR_UPSDriverNotStarted = 2480;
  static const DWORD NERR_UPSInvalidConfig = 2481;
  static const DWORD NERR_UPSInvalidCommPort = 2482;
  static const DWORD NERR_UPSSignalAsserted = 2483;
  static const DWORD NERR_UPSShutdownFailed = 2484;
  static const DWORD NERR_BadDosRetCode = 2500;
  static const DWORD NERR_ProgNeedsExtraMem = 2501;
  static const DWORD NERR_BadDosFunction = 2502;
  static const DWORD NERR_RemoteBootFailed = 2503;
  static const DWORD NERR_BadFileCheckSum = 2504;
  static const DWORD NERR_NoRplBootSystem = 2505;
  static const DWORD NERR_RplLoadrNetBiosErr = 2506;
  static const DWORD NERR_RplLoadrDiskErr = 2507;
  static const DWORD NERR_ImageParamErr = 2508;
  static const DWORD NERR_TooManyImageParams = 2509;
  static const DWORD NERR_NonDosFloppyUsed = 2510;
  static const DWORD NERR_RplBootRestart = 2511;
  static const DWORD NERR_RplSrvrCallFailed = 2512;
  static const DWORD NERR_CantConnectRplSrvr = 2513;
  static const DWORD NERR_CantOpenImageFile = 2514;
  static const DWORD NERR_CallingRplSrvr = 2515;
  static const DWORD NERR_StartingRplBoot = 2516;
  static const DWORD NERR_RplBootServiceTerm = 2517;
  static const DWORD NERR_RplBootStartFailed = 2518;
  static const DWORD NERR_RPL_CONNECTED = 2519;
  static const DWORD NERR_BrowserConfiguredToNotRun = 2550;
  static const DWORD NERR_RplNoAdaptersStarted = 2610;
  static const DWORD NERR_RplBadRegistry = 2611;
  static const DWORD NERR_RplBadDatabase = 2612;
  static const DWORD NERR_RplRplfilesShare = 2613;
  static const DWORD NERR_RplNotRplServer = 2614;
  static const DWORD NERR_RplCannotEnum = 2615;
  static const DWORD NERR_RplWkstaInfoCorrupted = 2616;
  static const DWORD NERR_RplWkstaNotFound = 2617;
  static const DWORD NERR_RplWkstaNameUnavailable = 2618;
  static const DWORD NERR_RplProfileInfoCorrupted = 2619;
  static const DWORD NERR_RplProfileNotFound = 2620;
  static const DWORD NERR_RplProfileNameUnavailable = 2621;
  static const DWORD NERR_RplProfileNotEmpty = 2622;
  static const DWORD NERR_RplConfigInfoCorrupted = 2623;
  static const DWORD NERR_RplConfigNotFound = 2624;
  static const DWORD NERR_RplAdapterInfoCorrupted = 2625;
  static const DWORD NERR_RplInternal = 2626;
  static const DWORD NERR_RplVendorInfoCorrupted = 2627;
  static const DWORD NERR_RplBootInfoCorrupted = 2628;
  static const DWORD NERR_RplWkstaNeedsUserAcct = 2629;
  static const DWORD NERR_RplNeedsRPLUSERAcct = 2630;
  static const DWORD NERR_RplBootNotFound = 2631;
  static const DWORD NERR_RplIncompatibleProfile = 2632;
  static const DWORD NERR_RplAdapterNameUnavailable = 2633;
  static const DWORD NERR_RplConfigNotEmpty = 2634;
  static const DWORD NERR_RplBootInUse = 2635;
  static const DWORD NERR_RplBackupDatabase = 2636;
  static const DWORD NERR_RplAdapterNotFound = 2637;
  static const DWORD NERR_RplVendorNotFound = 2638;
  static const DWORD NERR_RplVendorNameUnavailable = 2639;
  static const DWORD NERR_RplBootNameUnavailable = 2640;
  static const DWORD NERR_RplConfigNameUnavailable = 2641;
  static const DWORD NERR_DfsInternalCorruption = 2660;
  static const DWORD NERR_DfsVolumeDataCorrupt = 2661;
  static const DWORD NERR_DfsNoSuchVolume = 2662;
  static const DWORD NERR_DfsVolumeAlreadyExists = 2663;
  static const DWORD NERR_DfsAlreadyShared = 2664;
  static const DWORD NERR_DfsNoSuchShare = 2665;
  static const DWORD NERR_DfsNotALeafVolume = 2666;
  static const DWORD NERR_DfsLeafVolume = 2667;
  static const DWORD NERR_DfsVolumeHasMultipleServers = 2668;
  static const DWORD NERR_DfsCantCreateJunctionPoint = 2669;
  static const DWORD NERR_DfsServerNotDfsAware = 2670;
  static const DWORD NERR_DfsBadRenamePath = 2671;
  static const DWORD NERR_DfsVolumeIsOffline = 2672;
  static const DWORD NERR_DfsNoSuchServer = 2673;
  static const DWORD NERR_DfsCyclicalName = 2674;
  static const DWORD NERR_DfsNotSupportedInServerDfs = 2675;
  static const DWORD NERR_DfsDuplicateService = 2676;
  static const DWORD NERR_DfsCantRemoveLastServerShare = 2677;
  static const DWORD NERR_DfsVolumeIsInterDfs = 2678;
  static const DWORD NERR_DfsInconsistent = 2679;
  static const DWORD NERR_DfsServerUpgraded = 2680;
  static const DWORD NERR_DfsDataIsIdentical = 2681;
  static const DWORD NERR_DfsCantRemoveDfsRoot = 2682;
  static const DWORD NERR_DfsChildOrParentInDfs = 2683;
  static const DWORD NERR_DfsInternalError = 2690;
  static const DWORD NERR_SetupAlreadyJoined = 2691;
  static const DWORD NERR_SetupNotJoined = 2692;
  static const DWORD NERR_SetupDomainController = 2693;
  static const DWORD NERR_DefaultJoinRequired = 2694;
  static const DWORD NERR_InvalidWorkgroupName = 2695;
  static const DWORD NERR_NameUsesIncompatibleCodePage = 2696;
  static const DWORD NERR_ComputerAccountNotFound = 2697;
  static const DWORD NERR_PersonalSku = 2698;
  static const DWORD NERR_SetupCheckDNSConfig = 2699;
  static const DWORD NERR_PasswordMustChange = 2701;
  static const DWORD NERR_AccountLockedOut = 2702;
  static const DWORD NERR_PasswordTooLong = 2703;
  static const DWORD NERR_PasswordNotComplexEnough = 2704;
  static const DWORD NERR_PasswordFilterError = 2705;
  typedef UINT NET_COMPUTER_NAME_TYPE; //Alias
  static const UINT NetPrimaryComputerName = 0;
  static const UINT NetAlternateComputerNames = 1;
  static const UINT NetAllComputerNames = 2;
  static const UINT NetComputerNameTypeMax = 3;
  typedef UINT NETSETUP_NAME_TYPE; //Alias
  static const UINT NetSetupUnknown = 0;
  static const UINT NetSetupMachine = 1;
  static const UINT NetSetupWorkgroup = 2;
  static const UINT NetSetupDomain = 3;
  static const UINT NetSetupNonExistentDomain = 4;
  static const UINT NetSetupDnsMachine = 5;
  typedef LPVOID NET_VALIDATE_PASSWORD_TYPE; //Alias
  static const LPVOID NetValidateAuthentication = 1;
  static const LPVOID NetValidatePasswordChange = 2;
  static const LPVOID NetValidatePasswordReset = 3;
  typedef UINT DSROLE_PRIMARY_DOMAIN_INFO_LEVEL; //Alias
  static const UINT DsRolePrimaryDomainInfoBasic = 1;
  static const UINT DsRoleUpgradeStatus = 2;
  static const UINT DsRoleOperationState = 3;
  typedef DWORD WINAPI_ServerType; //Alias
  typedef UINT NETSETUP_JOIN_STATUS; //Alias
  typedef NETSETUP_JOIN_STATUS *PNETSETUP_JOIN_STATUS; //Pointer
  typedef DWORD WINAPI_NetUserGetLocalGroupsFlags; //Alias
  typedef ULONG WINAPI_DsGetDcNameFlags; //Alias
  DWORD          DsAddressToSiteNames(              LPCTSTR ComputerName, DWORD EntryCount, PSOCKET_ADDRESS SocketAddresses, LPTSTR** SiteNames);
  DWORD          DsAddressToSiteNamesEx(            LPCTSTR ComputerName, DWORD EntryCount, PSOCKET_ADDRESS SocketAddresses, LPTSTR** SiteNames, LPTSTR** SubnetNames);
  DWORD          DsDeregisterDnsHostRecords(        LPTSTR ServerName, LPTSTR DnsDomainName, GUID* DomainGuid, GUID* DsaGuid, LPTSTR DnsHostName);
  DWORD          DsEnumerateDomainTrusts(           LPTSTR ServerName, ULONG Flags, PDS_DOMAIN_TRUSTS* Domains, PULONG DomainCount);
  void           DsGetDcCloseW(                     HANDLE GetDcContextHandle);
  DWORD          DsGetDcName(                       LPCTSTR ComputerName, LPCTSTR DomainName, GUID* DomainGuid, LPCTSTR SiteName, WINAPI_DsGetDcNameFlags Flags, PDOMAIN_CONTROLLER_INFO* DomainControllerInfo);
  DWORD          DsGetDcNext(                       HANDLE GetDcContextHandle, PULONG SockAddressCount, LPSOCKET_ADDRESS* SockAddresses, LPTSTR* DnsHostName);
  DWORD          DsGetDcOpen(                       LPCTSTR DnsName, ULONG OptionFlags, LPCTSTR SiteName, GUID* DomainGuid, LPCTSTR DnsForestName, ULONG DcFlags, PHANDLE RetGetDcContext);
  DWORD          DsGetDcSiteCoverage(               LPCTSTR ServerName, PULONG EntryCount, LPTSTR** SiteNames);
  DWORD          DsGetForestTrustInformationW(      LPCWSTR ServerName, LPCWSTR TrustedDomainName, DWORD Flags, PLSA_FOREST_TRUST_INFORMATION* ForestTrustInfo);
  DWORD          DsGetSiteName(                     LPCTSTR ComputerName, LPTSTR* SiteName);
  void           DsMergeForestTrustInformationW(    LPCWSTR DomainName, PLSA_FOREST_TRUST_INFORMATION NewForestTrustInfo, PLSA_FOREST_TRUST_INFORMATION OldForestTrustInfo, PLSA_FOREST_TRUST_INFORMATION* ForestTrustInfo);
  void           DsRoleFreeMemory(                  PVOID Buffer);
  DWORD          DsRoleGetPrimaryDomainInformation( LPCWSTR lpServer, DSROLE_PRIMARY_DOMAIN_INFO_LEVEL InfoLevel, PBYTE* Buffer);
  DWORD          DsValidateSubnetName(              LPCTSTR SubnetName);
  NET_API_STATUS NetAlertRaise(                     LPCWSTR AlertEventName, LPVOID Buffer, DWORD BufferSize);
  NET_API_STATUS NetAlertRaiseEx(                   LPCWSTR AlertEventName, LPVOID VariableInfo, DWORD VariableInfoSize, LPCWSTR ServiceName);
  NET_API_STATUS NetApiBufferAllocate(              DWORD ByteCount, LPVOID* Buffer);
  NET_API_STATUS NetApiBufferFree(                  LPVOID Buffer);
  NET_API_STATUS NetApiBufferReallocate(            LPVOID OldBuffer, DWORD NewByteCount, LPVOID* NewBuffer);
  NET_API_STATUS NetApiBufferSize(                  LPVOID Buffer, LPDWORD ByteCount);
  NET_API_STATUS NetAddAlternateComputerName(       LPCWSTR Server, LPCWSTR AlternateName, LPCWSTR DomainAccount, LPCWSTR DomainAccountPassword, ULONG Reserved);
  NET_API_STATUS NetEnumerateComputerNames(         LPCWSTR Server, NET_COMPUTER_NAME_TYPE NameType, ULONG Reserved, PDWORD EntryCount, LPWSTR** ComputerNames);
  NET_API_STATUS NetGetJoinableOUs(                 LPCWSTR lpServer, LPCWSTR lpDomain, LPCWSTR lpAccount, LPCWSTR lpPassword, DWORD* OUCount, LPWSTR** OUs);
  NET_API_STATUS NetGetJoinInformation(             LPCWSTR lpServer, LPWSTR* lpNameBuffer, PNETSETUP_JOIN_STATUS BufferType);
  NET_API_STATUS NetJoinDomain(                     LPCWSTR lpServer, LPCWSTR lpDomain, LPCWSTR lpAccountOU, LPCWSTR lpAccount, LPCWSTR lpPassword, DWORD fJoinOptions);
  NET_API_STATUS NetLogonSetServiceBits(            LPWSTR ServerName, DWORD ServiceBitsOfInterest, DWORD ServiceBits);
  NET_API_STATUS NetProvisionComputerAccount(       LPCWSTR lpDomain, LPCWSTR lpMachineName, LPCWSTR lpMachineAccountOU, LPCWSTR lpDcName, DWORD dwOptions, PBYTE pProvisionBinData, DWORD pdwProvisionBinDataSize, LPWSTR pProvisionTextData);
  NET_API_STATUS NetRemoveAlternateComputerName(    LPCWSTR Server, LPCWSTR AlternateName, LPCWSTR DomainAccount, LPCWSTR DomainAccountPassword, ULONG Reserved);
  NET_API_STATUS NetRenameMachineInDomain(          LPCWSTR lpServer, LPCWSTR lpNewMachineName, LPCWSTR lpAccount, LPCWSTR lpPassword, DWORD fRenameOptions);
  NET_API_STATUS NetRequestOfflineDomainJoin(       BYTE* pProvisionBinData, DWORD cbProvisionBinDataSize, DWORD dwOptions, LPCWSTR lpWindowsPath);
  NET_API_STATUS NetSetPrimaryComputerName(         LPCWSTR Server, LPCWSTR PrimaryName, LPCWSTR DomainAccount, LPCWSTR DomainAccountPassword, ULONG Reserved);
  NET_API_STATUS NetUnjoinDomain(                   LPCWSTR lpServer, LPCWSTR lpAccount, LPCWSTR lpPassword, DWORD fUnjoinOptions);
  NET_API_STATUS NetValidateName(                   LPCWSTR lpServer, LPCWSTR lpName, LPCWSTR lpAccount, LPCWSTR lpPassword, NETSETUP_NAME_TYPE NameType);
  NET_API_STATUS NetGetAnyDCName(                   LPCWSTR servername, LPCWSTR domainname, LPBYTE* bufptr);
  NET_API_STATUS NetGetDCName(                      LPCWSTR servername, LPCWSTR domainname, LPBYTE* bufptr);
  NET_API_STATUS NetGetDisplayInformationIndex(     LPCWSTR ServerName, DWORD Level, LPCWSTR Prefix, LPDWORD Index);
  NET_API_STATUS NetQueryDisplayInformation(        LPCWSTR ServerName, DWORD Level, DWORD Index, DWORD EntriesRequested, DWORD PreferredMaximumLength, LPDWORD ReturnedEntryCount, PVOID* SortedBuffer);
  NET_API_STATUS NetGroupAdd(                       LPCWSTR servername, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NET_API_STATUS NetGroupAddUser(                   LPCWSTR servername, LPCWSTR GroupName, LPCWSTR username);
  NET_API_STATUS NetGroupDel(                       LPCWSTR servername, LPCWSTR groupname);
  NET_API_STATUS NetGroupDelUser(                   LPCWSTR servername, LPCWSTR GroupName, LPCWSTR Username);
  NET_API_STATUS NetGroupEnum(                      LPCWSTR servername, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, PDWORD_PTR resume_handle);
  NET_API_STATUS NetGroupGetInfo(                   LPCWSTR servername, LPCWSTR groupname, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetGroupGetUsers(                  LPCWSTR servername, LPCWSTR groupname, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, PDWORD_PTR ResumeHandle);
  NET_API_STATUS NetGroupSetInfo(                   LPCWSTR servername, LPCWSTR groupname, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NET_API_STATUS NetGroupSetUsers(                  LPCWSTR servername, LPCWSTR groupname, DWORD level, LPBYTE buf, DWORD totalentries);
  NET_API_STATUS NetLocalGroupAdd(                  LPCWSTR servername, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NET_API_STATUS NetLocalGroupAddMembers(           LPCWSTR servername, LPCWSTR groupname, DWORD level, LPBYTE buf, DWORD totalentries);
  NET_API_STATUS NetLocalGroupDel(                  LPCWSTR servername, LPCWSTR groupname);
  NET_API_STATUS NetLocalGroupDelMembers(           LPCWSTR servername, LPCWSTR groupname, DWORD level, LPBYTE buf, DWORD totalentries);
  NET_API_STATUS NetLocalGroupEnum(                 LPCWSTR servername, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, PDWORD_PTR resumehandle);
  NET_API_STATUS NetLocalGroupGetInfo(              LPCWSTR servername, LPCWSTR groupname, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetLocalGroupGetMembers(           LPCWSTR servername, LPCWSTR localgroupname, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, PDWORD_PTR resumehandle);
  NET_API_STATUS NetLocalGroupSetInfo(              LPCWSTR servername, LPCWSTR groupname, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NET_API_STATUS NetLocalGroupSetMembers(           LPCWSTR servername, LPCWSTR groupname, DWORD level, LPBYTE buf, DWORD totalentries);
  NET_API_STATUS NetMessageBufferSend(              LPCWSTR servername, LPCWSTR msgname, LPCWSTR fromname, LPBYTE buf, DWORD buflen);
  NET_API_STATUS NetMessageNameAdd(                 LPCWSTR servername, LPCWSTR msgname);
  NET_API_STATUS NetMessageNameDel(                 LPCWSTR servername, LPCWSTR msgname);
  NET_API_STATUS NetMessageNameEnum(                LPCWSTR servername, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resume_handle);
  NET_API_STATUS NetMessageNameGetInfo(             LPCWSTR servername, LPCWSTR msgname, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetRemoteComputerSupports(         LPCWSTR UncServerName, DWORD OptionsWanted, LPDWORD OptionsSupported);
  NET_API_STATUS NetRemoteTOD(                      LPCWSTR UncServerName, LPBYTE* BufferPtr);
  NET_API_STATUS NetScheduleJobAdd(                 LPCWSTR Servername, LPBYTE Buffer, LPDWORD JobId);
  NET_API_STATUS NetScheduleJobDel(                 LPCWSTR Servername, DWORD MinJobId, DWORD MaxJobId);
  NET_API_STATUS NetScheduleJobEnum(                LPCWSTR Servername, LPBYTE* PointerToBuffer, DWORD PreferredMaximumLength, LPDWORD EntriesRead, LPDWORD TotalEntries, LPDWORD ResumeHandle);
  NET_API_STATUS NetScheduleJobGetInfo(             LPCWSTR Servername, DWORD JobId, LPBYTE* PointerToBuffer);
  NET_API_STATUS NetServerDiskEnum(                 LPWSTR servername, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resume_handle);
  NET_API_STATUS NetServerEnum(                     LPCWSTR servername, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, WINAPI_ServerType servertype, LPCWSTR domain, LPDWORD resume_handle);
  NET_API_STATUS NetServerGetInfo(                  LPWSTR servername, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetServerSetInfo(                  LPWSTR servername, DWORD level, LPBYTE buf, LPDWORD ParmError);
  NET_API_STATUS NetServerComputerNameAdd(          LPWSTR ServerName, LPWSTR EmulatedDomainName, LPWSTR EmulatedServerName);
  NET_API_STATUS NetServerComputerNameDel(          LPWSTR ServerName, LPWSTR EmulatedServerName);
  NET_API_STATUS NetServerTransportAdd(             LPWSTR servername, DWORD level, LPBYTE bufptr);
  NET_API_STATUS NetServerTransportAddEx(           LPWSTR servername, DWORD level, LPBYTE bufptr);
  NET_API_STATUS NetServerTransportDel(             LPWSTR servername, DWORD level, LPBYTE bufptr);
  NET_API_STATUS NetServerTransportEnum(            LPWSTR servername, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resumehandle);
  NET_API_STATUS NetWkstaTransportEnum(             LPWSTR servername, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resumehandle);
  NET_API_STATUS NetUseAdd(                         LMSTR UncServerName, DWORD Level, LPBYTE Buf, LPDWORD ParmError);
  NET_API_STATUS NetUseDel(                         LMSTR UncServerName, LMSTR UseName, DWORD ForceCond);
  NET_API_STATUS NetUseEnum(                        LMSTR UncServerName, DWORD Level, LPBYTE* BufPtr, DWORD PreferedMaximumSize, LPDWORD EntriesRead, LPDWORD TotalEntries, LPDWORD ResumeHandle);
  NET_API_STATUS NetUseGetInfo(                     LMSTR UncServerName, LMSTR UseName, DWORD Level, LPBYTE* BufPtr);
  NET_API_STATUS NetUserAdd(                        LMSTR servername, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NET_API_STATUS NetUserChangePassword(             LPCWSTR domainname, LPCWSTR username, LPCWSTR oldpassword, LPCWSTR newpassword);
  NET_API_STATUS NetUserDel(                        LPCWSTR servername, LPCWSTR username);
  NET_API_STATUS NetUserEnum(                       LPCWSTR servername, DWORD level, DWORD filter, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resume_handle);
  NET_API_STATUS NetUserGetGroups(                  LPCWSTR servername, LPCWSTR username, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries);
  NET_API_STATUS NetUserGetInfo(                    LPCWSTR servername, LPCWSTR username, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetUserGetLocalGroups(             LPCWSTR servername, LPCWSTR username, DWORD level, WINAPI_NetUserGetLocalGroupsFlags flags, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries);
  NET_API_STATUS NetUserSetGroups(                  LPCWSTR servername, LPCWSTR username, DWORD level, LPBYTE buf, DWORD num_entries);
  NET_API_STATUS NetUserSetInfo(                    LPCWSTR servername, LPCWSTR username, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NET_API_STATUS NetUserModalsGet(                  LPCWSTR servername, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetUserModalsSet(                  LPCWSTR servername, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NET_API_STATUS NetValidatePasswordPolicyFree(     LPVOID* OutputArg);
  NET_API_STATUS NetValidatePasswordPolicy(         LPCWSTR ServerName, LPVOID Qualifier, NET_VALIDATE_PASSWORD_TYPE ValidationType, LPVOID InputArg, LPVOID OutputArg);
  NET_API_STATUS NetWkstaGetInfo(                   LPWSTR servername, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetWkstaSetInfo(                   LPWSTR servername, DWORD level, LPBYTE buffer, LPDWORD parm_err);
  NET_API_STATUS NetWkstaUserEnum(                  LPWSTR servername, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resumehandle);
  NET_API_STATUS NetWkstaUserGetInfo(               LPWSTR reserved, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetWkstaUserSetInfo(               LPWSTR reserved, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NTSTATUS       NetAddServiceAccount(              LPWSTR ServerName, LPWSTR AccountName, LPWSTR Reserved, DWORD Flags);
  NTSTATUS       NetEnumerateServiceAccounts(       LPWSTR ServerName, DWORD Flags, DWORD* AccountsCount, PZPWSTR* Accounts);
  NTSTATUS       NetIsServiceAccount(               LPWSTR ServerName, LPWSTR AccountName, BOOL* IsService);
  NTSTATUS       NetRemoveServiceAccount(           LPWSTR ServerName, LPWSTR AccountName, DWORD Flags);
  DWORD          DavAddConnection(                  HANDLE* ConnectionHandle, LPCWSTR RemoteName, LPCWSTR UserName, LPCWSTR Password, PBYTE ClientCert, DWORD CertSize);
  DWORD          DavDeleteConnection(               HANDLE ConnectionHandle);
  DWORD          DavFlushFile(                      HANDLE hFile);
  DWORD          DavGetExtendedError(               HANDLE hFile, DWORD* ExtError, LPWSTR ExtErrorString, DWORD* cChSize);
  DWORD          DavGetHTTPFromUNCPath(             LPCWSTR UncPath, LPWSTR HttpPath, LPDWORD lpSize);
  DWORD          DavGetUNCFromHTTPPath(             LPCWSTR HttpPath, LPWSTR UncPath, LPDWORD lpSize);
  NET_API_STATUS NetFileClose(                      LMSTR servername, DWORD fileid);
  NET_API_STATUS NetFileEnum(                       LMSTR servername, LMSTR basepath, LMSTR username, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, PDWORD_PTR resume_handle);
  NET_API_STATUS NetFileGetInfo(                    LMSTR servername, DWORD fileid, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetSessionDel(                     LPWSTR servername, LPWSTR UncClientName, LPWSTR username);
  NET_API_STATUS NetSessionEnum(                    LPWSTR servername, LPWSTR UncClientName, LPWSTR username, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resume_handle);
  NET_API_STATUS NetSessionGetInfo(                 LPWSTR servername, LPWSTR UncClientName, LPWSTR username, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetConnectionEnum(                 LMSTR servername, LMSTR qualifier, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resume_handle);
  NET_API_STATUS NetShareAdd(                       LPWSTR servername, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NET_API_STATUS NetShareCheck(                     LPWSTR servername, LPWSTR device, LPDWORD type);
  NET_API_STATUS NetShareDel(                       LMSTR servername, LMSTR netname, DWORD reserved);
  NET_API_STATUS NetShareDelEx(                     LMSTR servername, DWORD level, LPBYTE buf);
  NET_API_STATUS NetShareEnum(                      LPWSTR servername, DWORD level, LPBYTE* bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resume_handle);
  NET_API_STATUS NetShareGetInfo(                   LPWSTR servername, LPWSTR netname, DWORD level, LPBYTE* bufptr);
  NET_API_STATUS NetShareSetInfo(                   LPWSTR servername, LPWSTR netname, DWORD level, LPBYTE buf, LPDWORD parm_err);
  NET_API_STATUS NetStatisticsGet(                  LPWSTR server, LPWSTR service, DWORD level, DWORD options, LPBYTE* bufptr);
]]
return ffi.load( 'Netapi32.dll' )
